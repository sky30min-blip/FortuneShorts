# -*- coding: utf-8 -*-
"""
달의서재 시간대별 훅 멘트 (영상 생성 시 랜덤 선택)
"""
import random
from typing import TypedDict


class TimeSlot(TypedDict):
    id: str
    name: str
    color: str


HOOK_MENTS: dict[str, list[str]] = {
    "morning": [
        "아직 아무것도 쓰이지 않은 하루라는 첫 페이지, 어떤 기분 좋은 문장들로 채우고 싶으신가요?",
        "어제의 걱정은 밤사이 이슬처럼 흘려보내고, 오늘 당신을 기다리는 밝은 가능성만을 마주해 볼까요?",
        "새벽의 고요를 깨우는 새소리처럼, 당신의 잠든 행운을 깨워줄 신비로운 서재의 문을 열어봅니다.",
        "오늘 당신의 발걸음이 향하는 곳마다 행운의 꽃잎이 흩날리기를 바라며, 오늘의 방향을 살짝 엿보려 해요.",
        "새로운 하루를 여는 가장 설레는 방법, 당신의 마음속에 숨겨진 빛나는 태도를 카드로 찾아볼까요?",
    ],
    "lunch": [
        "잠시 눈을 감고 깊은 숨을 내쉬어 보세요. 남은 오후를 버티게 할 작은 행운이 당신 곁에 도착해 있어요.",
        "오전 내내 쉼 없이 달려온 당신께, 따뜻한 차 한 잔 같은 다정한 카드의 조언을 선물하고 싶어요.",
        "반복되는 일상 속에 숨겨진 보물 같은 찰나를 찾아낼 시간이에요. 오후의 길잡이가 되어줄 카드를 뽑아볼까요?",
        "마음이 조금 무거워졌다면 잠시 이곳에 내려놓으세요. 가벼워진 마음으로 오후를 맞이할 수 있는 힌트를 드릴게요.",
        "정신없는 시간들 속에서 나를 잃어버리진 않았나요? 잠시 멈춰 서서 내면의 목소리에 귀 기울여 보는 시간입니다.",
    ],
    "evening": [
        "모두가 잠잠해진 이 시간, 당신의 열정은 이제 막 기지개를 켜네요. 밤을 밝힐 당신만의 에너지를 읽어드릴게요.",
        "어둠이 짙어질수록 별은 더 선명하게 빛나죠. 지금 이 순간, 가장 눈부시게 빛날 당신의 운명을 확인해 보세요.",
        "세상의 시계가 느려지는 밤, 당신만의 시계는 이제 속도를 높일 준비가 되었나요? 그 뜨거운 여정에 지혜를 더해드릴게요.",
        "창밖의 달빛이 당신의 서재를 비추는 지금, 당신이 몰입할 그 일들에 확신이라는 마침표를 찍어드릴게요.",
        "남들이 끝이라고 말할 때 당신은 시작을 꿈꾸네요. 그 용기 있는 시작에 힘이 되어줄 밤의 수호자를 불러볼게요.",
    ],
}

# 운세는 아침에 한 번만 올리므로 하나로 통합
TIME_SLOTS: dict[str, TimeSlot] = {
    "morning": {"id": "morning", "name": "오늘의 운세", "color": "#FFD700"},
    "lunch": {"id": "lunch", "name": "오늘의 운세", "color": "#FFD700"},
    "evening": {"id": "evening", "name": "오늘의 운세", "color": "#FFD700"},
}

MINOR_FORTUNE_HOOKS: dict[str, list[str]] = {
    "건강운": [
        "오늘 하루 활력과 에너지가 당신을 어디로 이끌까요? 건강운 카드가 말해줄게요.",
        "몸과 마음의 균형, 오늘 당신에게 필요한 건 무엇일까요?",
        "건강한 하루를 위한 작은 신호, 카드가 알려드릴게요.",
    ],
    "애정운": [
        "마음이 끌리는 그 사람, 오늘의 카드가 조언해줄게요.",
        "사랑과 우정, 오늘 당신의 감정 흐름을 살펴볼까요?",
        "연애운이 움직이는 오늘, 카드에 귀 기울여 보세요.",
    ],
    "금전운": [
        "오늘의 재물운, 어떤 기운이 당신 곁에 있을까요?",
        "돈과 기회의 흐름, 카드가 알려주는 오늘의 금전운.",
        "재물이 흐르는 방향, 오늘 하루 확인해 볼까요?",
    ],
    "의사결정": [
        "고민되는 선택, 카드가 당신의 결단에 빛을 비춰줄게요.",
        "흔들리는 마음에 답을 찾을 시간, 의사결정 카드가 도와줄게요.",
        "어느 길로 갈지 막막하다면, 오늘의 카드가 힌트를 줄 거예요.",
    ],
}

# 메이저 22장 기반 추가 주제 (직장·학업·인간관계·재회 — 유지)
MAJOR_FORTUNE_HOOKS: dict[str, list[str]] = {
    "직장운": [
        "오늘 회사에서, 당신의 커리어에 카드가 말해줄 게 있어요.",
        "업무와 승진, 직장 안의 기운을 타로가 읽어드릴게요.",
        "직장인을 위한 한 장, 오늘의 직장운을 확인해 보세요.",
    ],
    "학업운": [
        "시험과 합격, 공부의 길. 카드가 오늘의 학업운을 비춰줄게요.",
        "오늘 공부할 때 어떤 기운이 당신 편일까요? 학업운 카드를 뽑아보세요.",
        "수험생을 위한 한 장, 학업운이 당신에게 전하는 메시지.",
    ],
    "인간관계운": [
        "주변 사람들과의 관계, 오늘 카드가 조언해줄게요.",
        "친구, 동료, 가족. 인간관계의 흐름을 타로로 읽어볼까요?",
        "오늘 당신을 둘러싼 사람들의 기운, 한 장으로 엿보세요.",
    ],
    "재회·이별운": [
        "그 사람과의 인연, 다시 만날까요? 카드가 말해줄게요.",
        "이별과 재회, 마음속 묻어 둔 그 감정을 타로가 읽어드려요.",
        "과거의 인연이 오늘 당신에게 전하는 메시지가 있어요.",
    ],
    # 💔 재회 및 미련 (20개)
    "재회 및 미련": [
        '"자니?" 밤 11시 이후 온 카톡, 진심일까?',
        "헤어진 지 3개월, 내 프로필 염탐하는 빈도",
        "차단당했는데... 풀릴 가능성 있는 날짜",
        "나를 잊었을까? 전 애인의 솔직한 현재 일상",
        "우리가 다시 만날 운명인지 알려주는 카드",
        "환승 이별한 그 사람, 지금 행복할까?",
        "먼저 연락하면 답장 올 확률 90% 이상인 타이밍",
        "다른 사람이 생겼을까? 그 사람 주변 이성 운세",
        "그 사람이 후회하며 울고 있는 밤의 리딩",
        "우리 이별의 진짜 원인, 나만 몰랐던 진실",
        "술 마시고 전화할까 고민 중인 그의 속마음",
        '"미안해"라고 말하고 싶은데... 그의 자존심 상태',
        "다음 주 월요일, 그 사람에게 연락 올까?",
        "재결합하면 또 헤어질까? 미래 결과 리딩",
        "그 사람이 내 인스타 스토리를 안 보는 이유",
        "나랑 헤어지고 나서 그 사람이 겪는 불운",
        "조만간 우연히 마주칠 장소와 시간대",
        "전 애인이 아직 보관 중인 내 물건의 의미",
        "나를 대신할 사람을 찾고 있을까?",
        "100일 뒤, 우리는 다시 남남일까 연인일까?",
    ],
    # 💖 썸 & 짝사랑 (20개)
    "썸 & 짝사랑": [
        "그 사람 눈에 비친 나의 진짜 첫인상 3가지",
        "썸일까 어장일까? 헷갈리는 행동의 마침표",
        "조만간 나에게 고백할 사람의 외모 특징",
        "짝사랑 끝내고 싶다면? 지금 당장 해야 할 행동",
        "내일 당장 선톡 올 가능성 몇 %일까?",
        "그 사람이 나를 보고 '귀엽다'고 생각한 순간",
        "우리 사이에 방해꾼이 있을까? 주변 인물 운세",
        "지금 톡 보내면 읽씹당할까, 안읽씹당할까?",
        "그 사람이 나에게 느끼는 권태로움의 정체",
        "고백하면 100% 성공하는 날짜와 장소",
        "썸남이 나에게 숨기고 있는 치명적인 비밀",
        "나를 이성으로 볼까, 그냥 편한 친구로 볼까?",
        "그 사람과 연인이 됐을 때의 스킨십 궁합",
        "내 카톡 보고 그 사람이 지은 표정 리딩",
        "짝사랑 상대가 좋아하는 '스타일' 분석 카드",
        "이번 주말 데이트 신청하면 수락할까?",
        "그 사람이 나를 차단할까 고민 중일까?",
        "나 말고 다른 썸녀가 있는지 확인하는 법",
        "조만간 우리 관계가 급진전될 사건",
        "그 사람이 먼저 번호 물어보게 만드는 팁",
    ],
    # 🔥 관계의 비밀 (20개)
    "관계의 비밀": [
        "나 말고 다른 사람도 있을까? (양다리 의심)",
        "절대 말 못 할 비밀... 그가 숨기는 과거",
        "우린 전생에 어떤 인연이었을까?",
        "조금 위험한 질문, 그 사람의 밤의 속마음",
        "지금 그 사람이 당신에게 가장 하고 싶은 욕구",
        "나를 이용하는 걸까, 사랑하는 걸까?",
        "그 사람이 나 몰래 내 친구에게 연락했을까?",
        "우리 관계가 여기까지인 진짜 이유 (소름 주의)",
        "그 사람의 핸드폰 사진첩에 내 사진이 있을까?",
        "나랑 있을 때 딴생각 하는 그 사람의 머릿속",
        "나에게 정떨어졌다고 느낀 결정적 순간",
        "집착일까 사랑일까? 상대의 소유욕 테스트",
        "사실 그 사람은 나를 속이고 있다?",
        "그 사람이 나를 보고 느꼈던 가장 야한 생각",
        "우리 관계가 깊어지지 않는 영적인 이유",
        "나만 모르는 그 사람의 이성 관계 복잡도",
        "그 사람이 나에게 기대하는 경제적 이득",
        "이별을 결심한 그 사람의 현재 진행 상황",
        "나를 만나고 나서 그 사람의 운이 좋아졌을까?",
        "우리가 끝내야 할까, 버텨야 할까? 최종 경고",
    ],
    # ✨ 운세 및 기회 (20개)
    "운세 및 기회": [
        "3일 안에 일어날 기분 좋은 변화와 사건",
        "조만간 들어올 돈복, 로또 살까요 말까요?",
        "나를 시기하는 사람 vs 도와줄 사람 구별법",
        "당신을 짝사랑하고 있는 의외의 인물",
        "이번 달, 당신에게 찾아올 운명적인 귀인의 특징",
        "지금 하는 일, 계속해도 될까? 직업운 리딩",
        "나를 괴롭히던 사람이 받을 업보(카르마)",
        "조만간 이직 제안이 올까? 합격운 리딩",
        "갑자기 연락 끊긴 친구의 진심",
        "오늘 밤 꿈에 나올 사람이 전하는 메시지",
        "당신의 매력이 가장 폭발하는 요일",
        "조만간 문서운(계약)이 들어올 가능성",
        "나를 질투하는 사람의 이니셜(자음) 힌트",
        "다음 주에 만날 새로운 인연의 키워드",
        "지금 고민 중인 그 문제, 해결될까? (Yes/No)",
        "당신이 곧 얻게 될 의외의 공짜 돈",
        "조상님이 전하는 이번 달 조심해야 할 것",
        "오늘 하루, 당신을 행복하게 해줄 컬러",
        "잃어버린 물건(또는 기회)을 찾을 수 있을까?",
        "2026년 상반기 대박 운세 키워드",
    ],
    # 테스트 (아침 3카드 스크립트용)
    "테스트": [
        "오늘의 변화 에너지, 카드가 말해줄게요.",
        "오늘 연락 가능성, 한 장으로 엿보는 시간.",
        "오늘 피해야 할 사람, 타로가 조언해드릴게요.",
    ],
}


def pick_random_hook() -> tuple[str, str, str]:
    """
    랜덤 시간대 + 해당 훅 멘트 반환

    Returns:
        (time_slot_id, hook_text, theme_name)
    """
    slot_id = random.choice(list(HOOK_MENTS.keys()))
    hook = random.choice(HOOK_MENTS[slot_id])
    theme = TIME_SLOTS[slot_id]["name"]
    return slot_id, hook, theme


def pick_hook_for_slot(slot_id: str) -> tuple[str, str]:
    """
    지정 시간대의 훅 멘트 반환 (아침/점심/저녁 선택 시)

    Returns:
        (hook_text, theme_name)
    """
    if slot_id not in HOOK_MENTS:
        slot_id = random.choice(list(HOOK_MENTS.keys()))
    hook = random.choice(HOOK_MENTS[slot_id])
    theme = TIME_SLOTS[slot_id]["name"]
    return hook, theme


def get_slot_color(slot_id: str) -> str:
    return TIME_SLOTS.get(slot_id, {}).get("color", "#9370DB")


def pick_minor_fortune_hook(fortune_type: str) -> tuple[str, str]:
    """마이너 아르카나용 훅 (건강운/애정운/금전운/의사결정)"""
    hooks = MINOR_FORTUNE_HOOKS.get(fortune_type, MINOR_FORTUNE_HOOKS["건강운"])
    return random.choice(hooks), fortune_type


def pick_major_fortune_hook(theme: str) -> tuple[str, str]:
    """메이저 아르카나 22장 기반 추가 주제 훅 (직장운/학업운/인간관계운/재회·이별운)"""
    hooks = MAJOR_FORTUNE_HOOKS.get(theme, MAJOR_FORTUNE_HOOKS["직장운"])
    return random.choice(hooks), theme


